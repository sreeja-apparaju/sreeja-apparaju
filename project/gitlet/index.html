<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
	<p><a href="https://sreeja-apparaju.github.io/portfolio.html"> < Back</a></p>
	<title>Rain Simulation in WebGL</title>
<style>
/* cspell:disable-file */
/* webkit printing magic: print all background colors */
html {
	-webkit-print-color-adjust: exact;
}
* {
	box-sizing: border-box;
	-webkit-print-color-adjust: exact;
}

html,
body {
	margin: 0;
	padding: 0;
}
@media only screen {
	body {
		margin: 2em auto;
		max-width: 900px;
		color: rgb(55, 53, 47);
	}
}

body {
	line-height: 1.5;
	white-space: pre-wrap;
}

a,
a.visited {
	color: inherit;
	text-decoration: underline;
}

.pdf-relative-link-path {
	font-size: 80%;
	color: #444;
}

h1,
h2,
h3 {
	letter-spacing: -0.01em;
	line-height: 1.2;
	font-weight: 600;
	margin-bottom: 0;
}

.page-title {
	font-size: 2.5rem;
	font-weight: 700;
	margin-top: 0;
	margin-bottom: 0.75em;
}

h1 {
	font-size: 1.875rem;
	margin-top: 1.875rem;
}

h2 {
	font-size: 1.5rem;
	margin-top: 1.5rem;
}

h3 {
	font-size: 1.25rem;
	margin-top: 1.25rem;
}

.source {
	border: 1px solid #ddd;
	border-radius: 3px;
	padding: 1.5em;
	word-break: break-all;
}

.callout {
	border-radius: 3px;
	padding: 1rem;
}

figure {
	margin: 1.25em 0;
	page-break-inside: avoid;
}

figcaption {
	opacity: 0.5;
	font-size: 85%;
	margin-top: 0.5em;
}

mark {
	background-color: transparent;
}

.indented {
	padding-left: 1.5em;
}

hr {
	background: transparent;
	display: block;
	width: 100%;
	height: 1px;
	visibility: visible;
	border: none;
	border-bottom: 1px solid rgba(55, 53, 47, 0.09);
}

img {
	max-width: 100%;
}

@media only print {
	img {
		max-height: 100vh;
		object-fit: contain;
	}
}

@page {
	margin: 1in;
}

.collection-content {
	font-size: 0.875rem;
}

.column-list {
	display: flex;
	justify-content: space-between;
}

.column {
	padding: 0 1em;
}

.column:first-child {
	padding-left: 0;
}

.column:last-child {
	padding-right: 0;
}

.table_of_contents-item {
	display: block;
	font-size: 0.875rem;
	line-height: 1.3;
	padding: 0.125rem;
}

.table_of_contents-indent-1 {
	margin-left: 1.5rem;
}

.table_of_contents-indent-2 {
	margin-left: 3rem;
}

.table_of_contents-indent-3 {
	margin-left: 4.5rem;
}

.table_of_contents-link {
	text-decoration: none;
	opacity: 0.7;
	border-bottom: 1px solid rgba(55, 53, 47, 0.18);
}

table,
th,
td {
	border: 1px solid rgba(55, 53, 47, 0.09);
	border-collapse: collapse;
}

table {
	border-left: none;
	border-right: none;
}

th,
td {
	font-weight: normal;
	padding: 0.25em 0.5em;
	line-height: 1.5;
	min-height: 1.5em;
	text-align: left;
}

th {
	color: rgba(55, 53, 47, 0.6);
}

ol,
ul {
	margin: 0;
	margin-block-start: 0.6em;
	margin-block-end: 0.6em;
}

li > ol:first-child,
li > ul:first-child {
	margin-block-start: 0.6em;
}

ul > li {
	list-style: disc;
}

ul.to-do-list {
	text-indent: -1.7em;
}

ul.to-do-list > li {
	list-style: none;
}

.to-do-children-checked {
	text-decoration: line-through;
	opacity: 0.375;
}

ul.toggle > li {
	list-style: none;
}

ul {
	padding-inline-start: 1.7em;
}

ul > li {
	padding-left: 0.1em;
}

ol {
	padding-inline-start: 1.6em;
}

ol > li {
	padding-left: 0.2em;
}

.mono ol {
	padding-inline-start: 2em;
}

.mono ol > li {
	text-indent: -0.4em;
}

.toggle {
	padding-inline-start: 0em;
	list-style-type: none;
}

/* Indent toggle children */
.toggle > li > details {
	padding-left: 1.7em;
}

.toggle > li > details > summary {
	margin-left: -1.1em;
}

.selected-value {
	display: inline-block;
	padding: 0 0.5em;
	background: rgba(206, 205, 202, 0.5);
	border-radius: 3px;
	margin-right: 0.5em;
	margin-top: 0.3em;
	margin-bottom: 0.3em;
	white-space: nowrap;
}

.collection-title {
	display: inline-block;
	margin-right: 1em;
}

.simple-table {
	margin-top: 1em;
	font-size: 0.875rem;
	empty-cells: show;
}
.simple-table td {
	height: 29px;
	min-width: 120px;
}

.simple-table th {
	height: 29px;
	min-width: 120px;
}

.simple-table-header-color {
	background: rgb(247, 246, 243);
	color: black;
}
.simple-table-header {
	font-weight: 500;
}

time {
	opacity: 0.5;
}

.icon {
	display: inline-block;
	max-width: 1.2em;
	max-height: 1.2em;
	text-decoration: none;
	vertical-align: text-bottom;
	margin-right: 0.5em;
}

img.icon {
	border-radius: 3px;
}

.user-icon {
	width: 1.5em;
	height: 1.5em;
	border-radius: 100%;
	margin-right: 0.5rem;
}

.user-icon-inner {
	font-size: 0.8em;
}

.text-icon {
	border: 1px solid #000;
	text-align: center;
}

.page-cover-image {
	display: block;
	object-fit: cover;
	width: 100%;
	max-height: 30vh;
}

.page-header-icon {
	font-size: 3rem;
	margin-bottom: 1rem;
}

.page-header-icon-with-cover {
	margin-top: -0.72em;
	margin-left: 0.07em;
}

.page-header-icon img {
	border-radius: 3px;
}

.link-to-page {
	margin: 1em 0;
	padding: 0;
	border: none;
	font-weight: 500;
}

p > .user {
	opacity: 0.5;
}

td > .user,
td > time {
	white-space: nowrap;
}

input[type="checkbox"] {
	transform: scale(1.5);
	margin-right: 0.6em;
	vertical-align: middle;
}

p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}

.image {
	border: none;
	margin: 1.5em 0;
	padding: 0;
	border-radius: 0;
	text-align: center;
}

.code,
code {
	background: rgba(135, 131, 120, 0.15);
	border-radius: 3px;
	padding: 0.2em 0.4em;
	border-radius: 3px;
	font-size: 85%;
	tab-size: 2;
}

code {
	color: #eb5757;
}

.code {
	padding: 1.5em 1em;
}

.code-wrap {
	white-space: pre-wrap;
	word-break: break-all;
}

.code > code {
	background: none;
	padding: 0;
	font-size: 100%;
	color: inherit;
}

blockquote {
	font-size: 1.25em;
	margin: 1em 0;
	padding-left: 1em;
	border-left: 3px solid rgb(55, 53, 47);
}

.bookmark {
	text-decoration: none;
	max-height: 8em;
	padding: 0;
	display: flex;
	width: 100%;
	align-items: stretch;
}

.bookmark-title {
	font-size: 0.85em;
	overflow: hidden;
	text-overflow: ellipsis;
	height: 1.75em;
	white-space: nowrap;
}

.bookmark-text {
	display: flex;
	flex-direction: column;
}

.bookmark-info {
	flex: 4 1 180px;
	padding: 12px 14px 14px;
	display: flex;
	flex-direction: column;
	justify-content: space-between;
}

.bookmark-image {
	width: 33%;
	flex: 1 1 180px;
	display: block;
	position: relative;
	object-fit: cover;
	border-radius: 1px;
}

.bookmark-description {
	color: rgba(55, 53, 47, 0.6);
	font-size: 0.75em;
	overflow: hidden;
	max-height: 4.5em;
	word-break: break-word;
}

.bookmark-href {
	font-size: 0.75em;
	margin-top: 0.25em;
}

.sans { font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; }
.code { font-family: "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; }
.serif { font-family: Lyon-Text, Georgia, ui-serif, serif; }
.mono { font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; }
.pdf .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK JP'; }
.pdf:lang(zh-CN) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC'; }
.pdf:lang(zh-TW) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK TC'; }
.pdf:lang(ko-KR) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK KR'; }
.pdf .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.pdf .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK JP'; }
.pdf:lang(zh-CN) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK SC'; }
.pdf:lang(zh-TW) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK TC'; }
.pdf:lang(ko-KR) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK KR'; }
.pdf .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.highlight-default {
	color: rgba(55, 53, 47, 1);
}
.highlight-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.highlight-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.highlight-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.highlight-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.highlight-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.highlight-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.highlight-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.highlight-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.highlight-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.highlight-gray_background {
	background: rgba(241, 241, 239, 1);
}
.highlight-brown_background {
	background: rgba(244, 238, 238, 1);
}
.highlight-orange_background {
	background: rgba(251, 236, 221, 1);
}
.highlight-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.highlight-teal_background {
	background: rgba(237, 243, 236, 1);
}
.highlight-blue_background {
	background: rgba(231, 243, 248, 1);
}
.highlight-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.highlight-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.highlight-red_background {
	background: rgba(253, 235, 236, 1);
}
.block-color-default {
	color: inherit;
	fill: inherit;
}
.block-color-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.block-color-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.block-color-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.block-color-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.block-color-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.block-color-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.block-color-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.block-color-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.block-color-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.block-color-gray_background {
	background: rgba(241, 241, 239, 1);
}
.block-color-brown_background {
	background: rgba(244, 238, 238, 1);
}
.block-color-orange_background {
	background: rgba(251, 236, 221, 1);
}
.block-color-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.block-color-teal_background {
	background: rgba(237, 243, 236, 1);
}
.block-color-blue_background {
	background: rgba(231, 243, 248, 1);
}
.block-color-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.block-color-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.block-color-red_background {
	background: rgba(253, 235, 236, 1);
}
.select-value-color-pink { background-color: rgba(245, 224, 233, 1); }
.select-value-color-purple { background-color: rgba(232, 222, 238, 1); }
.select-value-color-green { background-color: rgba(219, 237, 219, 1); }
.select-value-color-gray { background-color: rgba(227, 226, 224, 1); }
.select-value-color-opaquegray { background-color: rgba(255, 255, 255, 0.0375); }
.select-value-color-orange { background-color: rgba(250, 222, 201, 1); }
.select-value-color-brown { background-color: rgba(238, 224, 218, 1); }
.select-value-color-red { background-color: rgba(255, 226, 221, 1); }
.select-value-color-yellow { background-color: rgba(253, 236, 200, 1); }
.select-value-color-blue { background-color: rgba(211, 229, 239, 1); }

.checkbox {
	display: inline-flex;
	vertical-align: text-bottom;
	width: 16;
	height: 16;
	background-size: 16px;
	margin-left: 2px;
	margin-right: 5px;
}

.checkbox-on {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%2358A9D7%22%2F%3E%0A%3Cpath%20d%3D%22M6.71429%2012.2852L14%204.9995L12.7143%203.71436L6.71429%209.71378L3.28571%206.2831L2%207.57092L6.71429%2012.2852Z%22%20fill%3D%22white%22%2F%3E%0A%3C%2Fsvg%3E");
}

.checkbox-off {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%220.75%22%20y%3D%220.75%22%20width%3D%2214.5%22%20height%3D%2214.5%22%20fill%3D%22white%22%20stroke%3D%22%2336352F%22%20stroke-width%3D%221.5%22%2F%3E%0A%3C%2Fsvg%3E");
}
	
</style>
</head>
<body>
  <article id="6c102ea6-f2ca-4935-8a49-a5141a5643b8" class="page sans">
   <header><h1 class="page-title">Rebuilt lite Git version in Java</h1>
</header>


<div class="page-body">
  <nav id="7a82bb26-c86e-44ff-a9cb-36d9f72699c9" class="block-color-gray table_of_contents">
    
    <div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#a07b9d3f-0a85-4702-9632-73d2388f7544">Abstract</a></div>
    <div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#e9db1a03-1913-48b7-860e-9455bb723c6c">Technical Approach</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#f829958f-aecb-448b-b913-11a835903c49"><strong>Raindrop Motion Architecture</strong></a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#8943ee4b-b570-4ef5-8e83-240ed08c1f4b">Creating the Drop</a></div>
    <div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#eea46f7d-0b52-4463-bcb8-926d8d5f1275">Simulating the Motion of Each Drop</a></div>
    <div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#10f15745-a765-4dad-bad2-77c0393aa252">Rendering Each Raindrop (Drop Alpha)</a></div>
    <div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#469ba6ca-5b82-49cb-b87c-9af918e06d34">Incorporating Reflection, Refraction, and Alpha Blending</a></div>
    <div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#fdef2f38-12b0-498f-87ae-7bbde64f7f14">Shaders</a></div>
    <div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#ffb1a8ed-4a09-4a7e-b31b-cd3ecd066754">Challenges</a></div>
    <div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#019f92b3-b8c8-4577-b692-17687c330a39">Lessons Learned</a></div>
    <div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#f228459e-8472-43e4-828f-32e06b727d8e">Results</a></div>
    <div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#cf1afc36-0212-4b4d-8e4a-55588295d368">References</a></div>
    <div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#87bf331f-820c-44ec-8245-665e0a59b3c1">Contributions</a></div>
  </nav>
  

</div>



<h1 id="a07b9d3f-0a85-4702-9632-73d2388f7544" class="">Abstract</h1>
<hr id="0754705e-9d6b-416d-b865-1d9c548c3310"/><p id="73f65b71-a93b-44bd-a74e-79843ee9df7b" class="">For our project, we implemented a simulation of raindrops sliding on a glass window using WebGL for rendering graphics. The main components of this project were architecting the raindrops themselves, the motion of the raindrops, and the fragment shaders used to simulate the reflection and refraction of raindrops. We also used a physically-inspired hack on the background image, blurring it to give it the appearance of glass for the raindrops to &quot;slide&quot; on. Our simulation responds to user controls and there are two menus to change the background and shaders and a GUI available to manipulate different raindrop architecture and motion parameters.</p><h1 id="e9db1a03-1913-48b7-860e-9455bb723c6c" class="">Gitlet Architecture</h1>


<h2 id="f829958f-aecb-448b-b913-11a835903c49" class="">
  
  <strong>Raindrop Motion Architecture</strong></h2><p id="717d8941-7e31-49fa-9d1a-3aa24e1156b8" class="">When raindrops fall onto a window, they exhibit a few key behaviors. Below, we walk through the seven attributes of a raindrop that we define to characterize the behavior of a drop. Then, we discuss how we simulate the motion of each drop. This approach doesn&#x27;t explicitly model the viscocity of the water/gravitational forces/etc. - but it does look realistic, and the approach is inspired by these physical properties.</p>
  <hr id="ba541867-ef06-47c9-8d7b-13b641ad9a37"/>
  <h3 id="8943ee4b-b570-4ef5-8e83-240ed08c1f4b" class="">Creating the Drop</h3><ol type="1" id="7ccf7043-f6fe-4087-842d-c1ef9f08a6e7" class="numbered-list" start="1"><li><strong>Each drop has some initial size. </strong><ul id="9f680ee0-1beb-4de5-8cdc-5de231fda372" class="bulleted-list"><li style="list-style-type:disc">This size has three dimensions, and we can model it with a simplified three-dimensional representation <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo separator="true">,</mo><mi>d</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(x, y, d)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">d</span><span class="mclose">)</span></span></span></span></span><span>ï»¿</span></span>. </li></ul><ul id="d3736156-24cc-4508-a67a-443550a82b52" class="bulleted-list"><li style="list-style-type:disc">Since all drops in this simulation have the same z-position â€“ since they&#x27;re all on the same window plane â€“ the <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">d</span></span></span></span></span><span>ï»¿</span></span> parameter corresponds to the &quot;depth&quot; of the drop.</li></ul><ul id="424b6133-4c56-4a22-a07b-23e4170bf1b8" class="bulleted-list"><li style="list-style-type:disc">After visual inspection, we set the lower and upper bounds of the size of a drop to  <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mn>10</mn><mo separator="true">,</mo><mn>40</mn><mo stretchy="false">)</mo><mtext> pixels</mtext></mrow><annotation encoding="application/x-tex">(10, 40) \text{ pixels}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">10</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">40</span><span class="mclose">)</span><span class="mord text"><span class="mord"> pixels</span></span></span></span></span></span><span>ï»¿</span></span></li></ul></li></ol><ol type="1" id="e8fe3891-e73a-4a36-a267-5b4da3c3ed42" class="numbered-list" start="2"><li><strong>Each drop has some initial position. </strong><ul id="d3fbfbec-545b-40a7-98dd-b8449aa448fc" class="bulleted-list"><li style="list-style-type:disc">The <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">x</span></span></span></span></span><span>ï»¿</span></span> coordinate is chosen by <code>rand(this.width)</code></li></ul><ul id="859b1932-ff0a-49ae-a56f-676bfe017d16" class="bulleted-list"><li style="list-style-type:disc">The <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span></span><span>ï»¿</span></span> coordinate is chosen by <code>rand(this.height) * 0.95</code>, where <code>0.95</code> is a factor that forces each raindrop to be slightly above the bottom of the view</li></ul><ul id="c39252ab-1e48-42b9-aa59-2082c7aab6f9" class="bulleted-list"><li style="list-style-type:disc">Over time, the position varies due to the attributes defined below.</li></ul></li></ol><ol type="1" id="d839a508-f911-42de-8576-1a77ee2410a9" class="numbered-list" start="3"><li><strong>Each drop has some initial radius. </strong>This radius is chosen by <code>rand(min_radius, max_radius)</code><ul id="45b141c0-c734-46f1-a3f6-a914518fbe51" class="bulleted-list"><li style="list-style-type:disc">Over time, drops shrink as they dry up â€“ and larger drops collide and merge with smaller drops. Both of these physical features affect the radius of each drop.</li></ul></li></ol><ol type="1" id="c0b8e32c-4650-4976-9024-85e6d3cc177c" class="numbered-list" start="4"><li><strong>Each drop has some initial shrink. </strong><ul id="505a1414-2915-401e-a449-515a62894920" class="bulleted-list"><li style="list-style-type:disc">This aims to model the physical property of &quot;drying up&quot; â€“ smaller drops eventually dry up on a surface.</li></ul></li></ol><ol type="1" id="1ba4bda4-ebb1-4839-97b3-a51a7584f0ce" class="numbered-list" start="5"><li><strong>Each drop has some initial momentum. </strong><ul id="f84b627c-49e4-43a2-9f3a-58b7a0b17edb" class="bulleted-list"><li style="list-style-type:disc">Intuitively, we&#x27;d like larger drops to have larger momentums, so this momentum should be some random component scaled by the drop&#x27;s radius.</li></ul><ul id="f53f02bf-03cd-4bb4-8f22-fac34e53895e" class="bulleted-list"><li style="list-style-type:disc">Through trial and error, we define the initial momentum to be:<p id="e9097c94-93b9-40b7-9774-dfb6a2acba2b" class=""><code>0.5 * [(d.r - min_radius) / (max_radius - min_radius)] * rand(2)</code></p></li></ul><ul id="5caa4b76-7743-4532-947e-cae8d25c2174" class="bulleted-list"><li style="list-style-type:disc">Over time, the momentum should vary based on randomness (how likely a drop is to &quot;slip&quot; down) as well as due to collisions with other drops.</li></ul><ul id="5216e858-ae5c-44b0-84bb-f4805ddcaf4a" class="bulleted-list"><li style="list-style-type:disc">The default momentum variable, <code>momentum</code>, refers to the momentum along the main axis (y-axis). We also define a <code>momentumX</code> variable that models the change in x position due to collisions and other randomness (intuitively, drops rarely fall in a perfectly straight line).</li></ul></li></ol><ol type="1" id="afadc161-4c64-4523-8ce0-d51fdcd910f2" class="numbered-list" start="6"><li><strong>Each drop has some initial </strong><a href="https://en.wikipedia.org/wiki/Drop_impact"><strong>spread</strong></a><strong>. </strong><ul id="c9d5137e-f160-4d4e-b2d8-69356fd62c6c" class="bulleted-list"><li style="list-style-type:disc">The spread of a drop is a physically-inspired property that characterizes how much the drop spreads out on the surface when it comes into contact with it.</li></ul><ul id="dc106d5e-12e5-4e20-bfcc-49288f59e3be" class="bulleted-list"><li style="list-style-type:disc">We model this as two-dimensional spread (different spread for <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">x</span></span></span></span></span><span>ï»¿</span></span> and <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span></span><span>ï»¿</span></span> coordinates). We assign an initial spread value of <code>1.0</code> to each axis.</li></ul><ul id="3d5d7750-bc87-4c1e-8dad-19d42b5697c5" class="bulleted-list"><li style="list-style-type:disc">Over time, the spread should decrease (it originates from the initial impact, so this makes sense intuitively).</li></ul></li></ol><ol type="1" id="533a05eb-aef8-4a5c-bb0f-c618cdca6de6" class="numbered-list" start="7"><li><strong>When a large raindrop slides down a plane, it may spawn other child raindrops as it breaks up due to surface friction. </strong><ul id="972b45f4-3c72-42e8-9431-f13cfd0e483a" class="bulleted-list"><li style="list-style-type:disc">This doesn&#x27;t happen at every time step, so we need some variable to track when to spawn new raindrops.</li></ul></li></ol><hr id="669a752d-1a66-4814-a28c-25b27237eb58"/><h3 id="eea46f7d-0b52-4463-bcb8-926d8d5f1275" class="">Simulating the Motion of Each Drop</h3><p id="f641c287-d817-4e7a-8df3-2ede1a94c23e" class="">Our application maintains a <code>drops</code> array, which has a list of all current <code>Drop</code> objects on the screen at any particular point in time. The animation loop calls the <code>updateDrops</code> method.</p><p id="73878008-895d-4d1d-be9f-ae344fac23b5" class="">In <code>updateDrops</code>, we first add a raindrop if the number of raindrops on screen hasn&#x27;t exceeded the maximum capacity.</p><p id="d619c24a-c3c3-47ac-bc4b-f3bd6702f8a1" class="">Then, we apply the following logic to each drop.</p><ol type="1" id="9468adae-bd7d-4036-99dc-10aa48c008a8" class="numbered-list" start="1"><li><strong>Simulate the independent movement of each raindrop by modifying the raindrop&#x27;s </strong><code>momentum</code> <strong>attribute.</strong><ul id="ca4382d7-e4c4-4c31-8c81-727e0947f05c" class="bulleted-list"><li style="list-style-type:disc">Let <code>norm_drop</code> be the normalized drop size between <code>(0, 1)</code>.</li></ul><ul id="2213a4c4-8aa1-4941-87e8-03ee8a42a423" class="bulleted-list"><li style="list-style-type:disc">Each raindrop has some probability, <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mtext>slide</mtext></msub></mrow><annotation encoding="application/x-tex">p_{\text{slide}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">slide</span></span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>ï»¿</span></span>, of sliding down screen at any particular time step. Intuitively, we want this probability to correspond to the drop&#x27;s size, so we define it as follows:
<code>chance(0, 0.5 * norm_drop)</code></li></ul><ul id="a6453a04-cf09-47bc-9813-a12393794a48" class="bulleted-list"><li style="list-style-type:disc">If the drop should fall, then we update the momentum based on another random variable that&#x27;s also dependent on the size of the drop:<p id="d4bdb7e2-7231-4cd3-8687-aebd7b119894" class=""><code>drop.momentum += random(norm_drop)</code></p></li></ul></li></ol><ol type="1" id="2f937960-49d9-412a-92a9-62d0e7de30c3" class="numbered-list" start="2"><li><strong>Simulate the shrinking of drops due to them &quot;drying up.&quot;</strong><ul id="4a0581a7-9ddd-4161-aacf-728698872404" class="bulleted-list"><li style="list-style-type:disc">Intuitively, not all drops will shrink at the same rate, so we apply some randomness here.</li></ul><ul id="d22901d7-4825-4276-8983-ab877c314cdf" class="bulleted-list"><li style="list-style-type:disc">We increase the <code>drop.shrink</code> attribute by <code>0.01</code> with a probability of <code>0.05</code>.</li></ul><ul id="868882cc-75ec-471b-ae36-a6b921329677" class="bulleted-list"><li style="list-style-type:disc">Then, we reduce the radius by the current <code>drop.shrink</code> value. </li></ul><ul id="c2c509e7-a6d4-4461-a60e-a645dea12d35" class="bulleted-list"><li style="list-style-type:disc">As such, the drop shrinks faster over time, since the <code>drop.shrink</code> value increases up over time.</li></ul></li></ol><ol type="1" id="06a10585-5929-40fb-afb5-fad4b7e1ea0c" class="numbered-list" start="3"><li><strong>Simulate the spread of each drop.</strong><ul id="f0e37c5a-854a-420c-8f42-d8170bc4f62c" class="bulleted-list"><li style="list-style-type:disc">Over time, the spread decreases, so we reduce <code>drop.spreadX</code> and <code>drop.spreadY</code> by a constant value (<code>0.9</code> and <code>0.4</code>, respectively).<figure class="block-color-gray_background callout" style="white-space:pre-wrap;display:flex" id="cc8f3c44-a0c0-441d-9554-8d79444e27ec"><div style="font-size:1.5em"><span class="icon">ðŸ’­</span></div><div style="width:100%">This is inspired by <a href="https://en.wikipedia.org/wiki/Drop_impact">this Wikipedia article describing drop impact</a> - it identifies two possible behaviors (spreading and splashing) - for simplicity, we only implement spreading. This effectively assumes that a drop hits the glass at a velocity below the critical threshold for splashing/scattering.</div></figure></li></ul></li></ol><ol type="1" id="8befd25b-94f8-42d5-8543-fc96e4e4a677" class="numbered-list" start="4"><li><strong>Add new child drops in the path of this drop if necessary.</strong><ul id="d9a3aec0-3d92-4709-923f-e1fcf4bb8f6a" class="bulleted-list"><li style="list-style-type:disc">Drops are spawned at a rate dependent on the size of the drop and the current momentum. </li></ul><ul id="729afcc3-3cf2-42d8-9f14-f0fc6c33c975" class="bulleted-list"><li style="list-style-type:disc">When a child drop is created, its size is smaller than the parent drop and its position is slightly above the parent drop</li></ul></li></ol><ol type="1" id="e93a476f-f7e7-4516-a326-1a6524ce5f82" class="numbered-list" start="5"><li><strong>If the drop moved, then update the drop&#x27;s position. </strong><ul id="b54142e7-f2e9-4b5c-8f07-d0edf8505d8f" class="bulleted-list"><li style="list-style-type:disc">If the drop went off screen, then remove it from the array.</li></ul><ul id="78c58fc8-e182-4ce8-afe9-9fb3a2414c5e" class="bulleted-list"><li style="list-style-type:disc">Check for a collision with another drop:<ul id="752b6b8f-d6a3-48dd-ad10-d58901e7b717" class="bulleted-list"><li style="list-style-type:circle">Apply the <span style="border-bottom:0.05em solid">distance formula</span> to calculate the relative distance between the two drops.</li></ul><ul id="3ae58ea7-1410-48d9-9937-74e738752561" class="bulleted-list"><li style="list-style-type:circle">If a collision occurred, calculate a new radius based on the combined area of both drops.</li></ul><ul id="54abc894-bd67-4f1b-8578-a7eacade395d" class="bulleted-list"><li style="list-style-type:circle">Update the original drop&#x27;s radius, momentum, and spread. Also, update the momentum in the x-axis here (realistically, when a drop collides, it may not fall in a straight line.</li></ul></li></ul></li></ol><ol type="1" id="d171db39-aaac-4056-b5e5-af18e352eb70" class="numbered-list" start="6"><li><strong>Simulate friction by applying an upwards force to each drop. </strong><ul id="53231e7b-2179-46a3-b309-12a9df2dd588" class="bulleted-list"><li style="list-style-type:disc">Intuitively, drops won&#x27;t slide smoothly down screen.</li></ul><ul id="009d1b2b-1634-43f1-bc8b-bcc2aedfafab" class="bulleted-list"><li style="list-style-type:disc">Effectively, we slow down each drop&#x27;s momentum by a factor that&#x27;s dependent on the current momentum and drop radius. </li></ul></li></ol><ol type="1" id="ef7ad7c0-d706-41b1-a4b2-3ff0ecd547e5" class="numbered-list" start="7"><li><strong>Redraw each drop to the screen.</strong></li></ol><hr id="4691bd8e-ce10-48d5-a80a-f56e674e7230"/><h3 id="10f15745-a765-4dad-bad2-77c0393aa252" class="">Rendering Each Raindrop (Drop Alpha)</h3><p id="fc19d6e3-3323-4556-82b3-949087a47afe" class="">We use the approach <a href="https://tympanus.net/codrops/2015/11/04/rain-water-effect-experiments/">here</a> in order to render each raindrop. </p><div id="b7aa93f8-f162-4d04-a80b-0451c9f76386" class="column-list"><div id="195295bd-a455-4184-af0c-9a1fb6b6fe2a" style="width:37.50000000000001%" class="column"><figure id="58170314-e7c0-4aa9-9a99-e0f69ab2eb50" class="image"><a href="CS%20184%20Final%20Project%20Writeup%206c102ea6f2ca49358a49a5141a5643b8/Screen_Recording_2021-05-05_at_6.08.04_PM.gif"><img style="width:336px" src="CS%20184%20Final%20Project%20Writeup%206c102ea6f2ca49358a49a5141a5643b8/Screen_Recording_2021-05-05_at_6.08.04_PM.gif"/></a><figcaption>Every raindrop starts off as a square canvas, as seen in this image.</figcaption></figure></div><div id="744dd943-e56b-4903-98d9-015dce77f4c1" style="width:29.166666666666675%" class="column"><figure id="f9bd0812-a17d-451e-a63b-e9872c75b522" class="image"><a href="CS%20184%20Final%20Project%20Writeup%206c102ea6f2ca49358a49a5141a5643b8/drop-alpha.png"><img style="width:120px" src="CS%20184%20Final%20Project%20Writeup%206c102ea6f2ca49358a49a5141a5643b8/drop-alpha.png"/></a><figcaption>We use this image as an alpha layer to create the raindrop shape. </figcaption></figure><p id="7f57554c-3a05-4d10-95dd-95f299baee2b" class="">
</p></div><div id="11b45b1b-3acf-440b-a6d4-ebcbc5fe9cb0" style="width:33.33333333333333%" class="column"><figure id="cb931885-1705-486e-a1d3-3b8214a86d10" class="image"><a href="CS%20184%20Final%20Project%20Writeup%206c102ea6f2ca49358a49a5141a5643b8/drop-color.png"><img style="width:128px" src="CS%20184%20Final%20Project%20Writeup%206c102ea6f2ca49358a49a5141a5643b8/drop-color.png"/></a><figcaption>We utilize the rgb values to model the depth and refraction vectors of the droplet.</figcaption></figure></div></div><p id="c50283d0-6d75-4fbb-af97-4878f7791f3a" class="">In order to shape our droplets, we utilize a css feature that allows us to &quot;layer&quot; the drop_alpha image over each of our raindrop canvases. In effect, this layering will only show the parts of the canvas that are encompassed in the black portion of the alpha image. Since the image is blurred around the edge, that makes for natural and realistic-looking raindrops!</p><hr id="c5647437-38b6-412a-bdfc-a2ccf8dc11b4"/><h3 id="469ba6ca-5b82-49cb-b87c-9af918e06d34" class="">Incorporating Reflection, Refraction, and Alpha Blending</h3><p id="d2cfb05f-6bdf-4616-86dd-0aa666b3ea53" class=""><strong>REFRACTION: </strong>In order to model refraction in the droplet, we make use of the drop color image. Using the x and y coordinates, we calculate an arbitrary incoming light ray&#x27;s refraction vector into the water droplet. By flipping this vector, we are able to backtrace the ray to find the background pixel that will be shown at the given pixel. Then, we use alpha blending to create realistic, semi-translucent coloring. For alpha blending, we have a couple different cases:</p><ul id="eb0b4fb3-08de-4fb7-8222-381715d5cd41" class="bulleted-list"><li style="list-style-type:disc">If the foreground (raindrop canvas at that point) is transparent (alpha = 0.0), we only return the background RGB values, which means no raindrop is present at that location and no computation is necessary. </li></ul><ul id="9b432e00-753b-4095-8c73-1c6f9ad6e965" class="bulleted-list"><li style="list-style-type:disc">Similarly, if the background (scene) is opaque (alpha = 1.0), add foreground rgb values on top of the background RGB values.</li></ul><ul id="8f270be2-9f31-49e0-a01e-c6ae3fd0d5d6" class="bulleted-list"><li style="list-style-type:disc">If neither of these cases are true, we perform regular alpha blending. </li></ul><p id="bc88aede-a43a-4bff-879a-b68ba4c9e7e7" class=""><strong>REFLECTION: </strong>We compute reflection values by by simply taking the background, scaling it down, flipping it across the y-axis, and applying an alpha transparency value to it. This reflection component gives it a depth effect that makes the image look much more real and 3D.</p><p id="534006a7-34bb-4c94-8063-54730c7be37b" class="">Finally, we created a variable that connects to our RaindropRenderer, which pipes in a user input from our GUI. This variable controls the mode, and as such, the shader that&#x27;s applied to the image! </p><hr id="fca0f3c1-3773-4915-bd81-3c9e594724ea"/><h3 id="fdef2f38-12b0-498f-87ae-7bbde64f7f14" class="">Shaders</h3><p id="de69d588-8b69-4bb7-aedf-357a64c0a2be" class="">We implemented two shaders that built off of our baseline, realistic shader. These shaders were based on a <a href="https://www.shadertoy.com/view/MdffDS">shadertoy project</a> we came across in our research.</p><p id="888acec5-5fea-4632-b508-1a151c61fc9b" class=""><strong>The Rainbow Shader</strong></p><p id="cfb417ff-cd5a-447f-99a9-4d00aeafe9bd" class="">The color augmentation seen here is actually a result of applying a uniform color transformation to the given RGB values. We take in given color values and apply an arbitrary scaling of saturation, hue, and brightness for making finer changes. We then convert our HSV value back into the RGB color space. This is our returned value! </p><p id="96f50c32-f639-4932-bc2d-ea0adb406d07" class="">One interesting element to note here is our separation of the foreground and background. When processing the image, a raindrop is present when the foreground has an alpha value &gt; 0.0, since the raindrops are only present in the this foreground canvas. As such, we were able to choose when to apply our filter based on this alpha value. For the rainbow filter, we decided to only apply this shader to our raindrops, which gives it the really interesting effect you see in our demo!</p><p id="9a88ba79-1b9a-4571-a501-60a2cceebe0a" class=""><strong>The Spooky Shader</strong></p><p id="61558b98-c890-40b5-891d-98fbf071a81f" class="">This shader has very similar color processing to the rainbow shader. However, after computing the augmented rgb values, we applied a vectorized filter to the values to convert them into grayscale. We applied this shader to the entire backdrop (both the foreground and the background).</p><figure id="029d04ad-0274-4268-b6b5-a2c0ac7272f1" class="image"><a href="CS%20184%20Final%20Project%20Writeup%206c102ea6f2ca49358a49a5141a5643b8/shaders.gif"><img style="width:432px" src="CS%20184%20Final%20Project%20Writeup%206c102ea6f2ca49358a49a5141a5643b8/shaders.gif"/></a><figcaption>Shaders Menu: Select between the original, rainbow, and a black and white (haunted) shaders</figcaption></figure><hr id="50f11313-cd15-40b6-bbb4-77c4d9fd6f0a"/><h2 id="ffb1a8ed-4a09-4a7e-b31b-cd3ecd066754" class="">Challenges</h2><p id="978680a5-d4df-4cdf-b62e-d49752c8ea4f" class="">One of the challenges we encountered was designing the architecture to track the spawning of new child drops efficiently. As it turns out, we needed to set a <code>parent</code> attribute to the drop in order to ensure that the original drop didn&#x27;t immediately collide with the newly spawned dot in the collision logic below.</p><p id="ca8ffc59-fc4f-407c-aeb9-1e599dd57ec9" class="">Fine tuning the shrink/spread parameters was tricky - we wrote this logic, and then disabled it until we had built our GUI layer. Then, we used the sliders to determine parameters for shrink and spread that seemed realistic. </p><h2 id="019f92b3-b8c8-4577-b692-17687c330a39" class="">Lessons Learned</h2><p id="21442e18-fed5-4841-9b77-d77bde3a0324" class="">One of the things that we learned is that for a lot of things in computer graphics, it&#x27;s possible to get results that are quite realistic without fully modeling the physics behind every single particle in the scene. Our approach to rendering raindrops was very much a hack (we&#x27;re not independently modeling each water atom + the viscosity between them).</p><p id="424540f6-8700-4789-9810-49b3346fd939" class="">We also learned how to use WebGL and JavaScript for graphics implementations. This included understanding how to debug, format, and integrate new libraries within our HTML/CSS/JS workspace.</p><h1 id="f228459e-8472-43e4-828f-32e06b727d8e" class="">Results</h1><hr id="f3434bbb-d642-448e-9243-a6c3541ef830"/><p id="8bd51a43-8ef3-4e4f-87cc-65e51771a137" class="">We implemented a GUI to let users control the raindrop architecture, motion, scene background, and fragment shaders. A full project simulation is available <a href="https://cs184-raineffect.web.app">here</a>. The following animations show these results:</p><div id="29c3a397-4c67-42b4-ad1e-9ea7b011007d" class="column-list"><div id="969000e1-a13e-41fe-8e02-26c052a3b234" style="width:50%" class="column"><figure id="6f7cc9be-f84e-460a-8ae1-e00c637d728f" class="image"><a href="CS%20184%20Final%20Project%20Writeup%206c102ea6f2ca49358a49a5141a5643b8/unnamed.gif"><img style="width:918px" src="CS%20184%20Final%20Project%20Writeup%206c102ea6f2ca49358a49a5141a5643b8/unnamed.gif"/></a><figcaption>Original.</figcaption></figure><figure id="f1f69e6f-0807-4a1a-b8fc-8a911065a1f8" class="image"><a href="CS%20184%20Final%20Project%20Writeup%206c102ea6f2ca49358a49a5141a5643b8/pasted_image_0.gif"><img style="width:918px" src="CS%20184%20Final%20Project%20Writeup%206c102ea6f2ca49358a49a5141a5643b8/pasted_image_0.gif"/></a><figcaption>Extra friction. Notice how raindrops pretty much don&#x27;t slide anymore - they land, and shrink until they disappear.</figcaption></figure><figure id="360285cf-5955-433c-848a-12431b022e27" class="image"><a href="CS%20184%20Final%20Project%20Writeup%206c102ea6f2ca49358a49a5141a5643b8/without-friction.gif"><img style="width:918px" src="CS%20184%20Final%20Project%20Writeup%206c102ea6f2ca49358a49a5141a5643b8/without-friction.gif"/></a><figcaption>Without friction. Notice how the rate at which raindrops fall is constant.</figcaption></figure></div><div id="9c554ddd-b277-4928-8a50-0f8b9541935a" style="width:50%" class="column"><figure id="e2b6a7b1-e11e-4edc-a575-48c174f0169c" class="image"><a href="CS%20184%20Final%20Project%20Writeup%206c102ea6f2ca49358a49a5141a5643b8/pasted_image_0-3.gif"><img style="width:918px" src="CS%20184%20Final%20Project%20Writeup%206c102ea6f2ca49358a49a5141a5643b8/pasted_image_0-3.gif"/></a><figcaption>Huge drops. </figcaption></figure><figure id="61c4daba-5316-4a54-8eaa-711bb3a56efc" class="image"><a href="CS%20184%20Final%20Project%20Writeup%206c102ea6f2ca49358a49a5141a5643b8/pasted_image_0%201.gif"><img style="width:918px" src="CS%20184%20Final%20Project%20Writeup%206c102ea6f2ca49358a49a5141a5643b8/pasted_image_0%201.gif"/></a><figcaption>Without spawn. Notice how the drops don&#x27;t spawn new drops behind them (once a raindrop lands on the plane, it slides down, and doesn&#x27;t break up).</figcaption></figure><figure id="b6204a65-2f79-40a9-b18d-8dc13931231f" class="image"><a href="CS%20184%20Final%20Project%20Writeup%206c102ea6f2ca49358a49a5141a5643b8/pasted_image_0-2.gif"><img style="width:918px" src="CS%20184%20Final%20Project%20Writeup%206c102ea6f2ca49358a49a5141a5643b8/pasted_image_0-2.gif"/></a><figcaption>Without shrink. Notice how raindrops don&#x27;t get any smaller.</figcaption></figure></div></div><p id="522ffc2f-7c9f-4a67-a6b6-89b16e3a5fb0" class="">We also implemented custom menus to change the scene background and the shaders used:</p><div id="9f30a56d-f196-4c89-9ac3-43dfa8657505" class="column-list"><div id="e5227f3d-e7ec-4962-a3b7-d0c9db379298" style="width:50%" class="column"><figure id="c3a4145d-3454-4f12-9453-f91bd8705696" class="image"><a href="CS%20184%20Final%20Project%20Writeup%206c102ea6f2ca49358a49a5141a5643b8/background.gif"><img style="width:600px" src="CS%20184%20Final%20Project%20Writeup%206c102ea6f2ca49358a49a5141a5643b8/background.gif"/></a><figcaption>Background Menu: Select between a background of Berkeley, a city, and a mountain scene.</figcaption></figure></div><div id="d5878aa5-7a2d-4776-9120-17c85db0824d" style="width:50%" class="column"><figure id="0fb28372-88f5-4607-8c9f-17ce26abc12d" class="image"><a href="CS%20184%20Final%20Project%20Writeup%206c102ea6f2ca49358a49a5141a5643b8/shaders.gif"><img style="width:600px" src="CS%20184%20Final%20Project%20Writeup%206c102ea6f2ca49358a49a5141a5643b8/shaders.gif"/></a><figcaption>Shaders Menu: Select between the original, rainbow, and a black and white (haunted) shaders</figcaption></figure><p id="384917b1-a740-4d13-aab3-cf1249aa76fc" class="">
</p></div></div><p id="dbb04022-582a-4f89-b755-a3174a2f3e93" class="">Lastly, we used <a href="https://github.com/dataarts/dat.gui">dat.GUI</a> to let users alter the architecture and motion of the raindrops:</p><div id="fb30f427-65f2-4011-93b4-7d50f0ecf5c8" class="column-list"><div id="f6c7df42-1dc8-48c1-a30a-5f834b75290e" style="width:50%" class="column"><figure id="16d40e88-af5d-48f1-92c6-f5c52766bd9e" class="image"><a href="CS%20184%20Final%20Project%20Writeup%206c102ea6f2ca49358a49a5141a5643b8/raindropmotion.gif"><img style="width:600px" src="CS%20184%20Final%20Project%20Writeup%206c102ea6f2ca49358a49a5141a5643b8/raindropmotion.gif"/></a><figcaption>Raindrop Architecture Menu - Control fall amount, friction, and raindrop radius</figcaption></figure></div><div id="2d596487-d067-4638-b680-421ecb081dbe" style="width:50%" class="column"><figure id="86f0cbaa-b985-440a-9df4-48b82d71982b" class="image"><a href="CS%20184%20Final%20Project%20Writeup%206c102ea6f2ca49358a49a5141a5643b8/raindrop-motion.gif"><img style="width:600px" src="CS%20184%20Final%20Project%20Writeup%206c102ea6f2ca49358a49a5141a5643b8/raindrop-motion.gif"/></a><figcaption>Raindrop Motion Menu - Control spread, shrink, spawn, depth, and raindrop speed</figcaption></figure></div></div><h1 id="cf1afc36-0212-4b4d-8e4a-55588295d368" class="">References</h1><hr id="af80b4b5-5382-4d51-9bc5-c3d0c564a233"/><ul id="414de516-6019-45d7-b52a-c7cab13b2725" class="bulleted-list"><li style="list-style-type:disc"><a href="https://api.flutter.dev/flutter/dart-ui/Color/alphaBlend.html">Alpha Blending</a></li></ul><ul id="8073f90a-f9f5-45be-ae3b-f098fd1d9579" class="bulleted-list"><li style="list-style-type:disc"><a href="https://www.shadertoy.com/view/MdffDS">Shader References</a></li></ul><ul id="76a35658-ed47-4a4b-b8c2-d64805fc96a4" class="bulleted-list"><li style="list-style-type:disc"><a href="https://www.scratchapixel.com/lessons/3d-basic-rendering/introduction-to-shading/reflection-refraction-fresnel">Refraction reference</a></li></ul><ul id="21e31457-3545-4b08-ac64-e2d3d6066515" class="bulleted-list"><li style="list-style-type:disc"><a href="https://tympanus.net/codrops/2015/11/04/rain-water-effect-experiments/">Rain &amp; Water Experiment</a></li></ul><ul id="e15475b5-ffb3-41d9-a48e-78c2ebb82bf1" class="bulleted-list"><li style="list-style-type:disc"><a href="https://github.com/dataarts/dat.gui">dat.GUI Docs</a> + <a href="https://www.youtube.com/watch?v=ej6Sfm6oA-k">Video</a></li></ul><ul id="cb03bcf7-8140-422f-8d3e-e3b824d81651" class="bulleted-list"><li style="list-style-type:disc"><a href="https://emergent-scientist.edp-open.org/articles/emsci/full_html/2019/01/emsci180004/emsci180004.html">Motion of a raindrop on a carside window</a></li></ul><h1 id="87bf331f-820c-44ec-8245-665e0a59b3c1" class="">Contributions</h1><hr id="3c7830db-c8e8-4e00-9f4b-8449dc2ac81a"/><p id="71e459eb-357a-4ae1-9cb7-d10bd1cd9558" class="">Shomil: Initial framework setup, raindrop architecture and mathematical motion simulation</p><p id="2d754a69-f099-4d08-ac87-1cef2c4eb68b" class="">Anjali: Wrote the fragment shaders (reflection, refraction, alpha drop + blending)</p><p id="c465f29d-83d8-438a-ad81-a8f8cf124d3c" class="">Niky: Configured background image setup, user interface menus + dat.GUI implementation</p><p id="1d19cb56-c404-4b26-9939-10ce8b385eb0" class="">
</p></div></article></body></html>
